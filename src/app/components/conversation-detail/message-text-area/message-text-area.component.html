<!-- <ion-grid>
  <ion-row id="message-text-area">
    <ion-col col-auto>
      <div class="buttons-left">

        <ion-button ion-button fill="clear" class="upload-image-btn">
          <ion-icon slot="icon-only" lazy="true" name="attach-outline"
            style="font-size: 30px;transform: rotate(42deg);"></ion-icon>
          <input #fileInput type="file" (change)="onFileSelected($event)" capture="camera" id="file-input"
            [accept]="fileUploadAccept">
        </ion-button>
      </div>

      <div class="text-message">
        <ion-textarea id="ion-textarea" #messageTextArea #message_text_area #textArea rows="1"
          [placeholder]="TEXAREA_PLACEHOLDER" autosize="false" auto-grow="true" autofocus="true" [value]=""
          [(ngModel)]="messageString" (ionChange)="ionChange($event);"
          (keydown.enter)="onKeydown($event, messageString)" (paste)="onPaste($event)">
        </ion-textarea>
      </div>

      <div class="buttons-right">
        <ion-button [disabled]="conversationEnabled === false" class="send-button right active" ion-button fill="clear"
          (click)="sendMessage(messageString)">
          <ion-icon
            [ngClass]="{'send-msg-disabled': conversationEnabled === false,'send-msg-activated': conversationEnabled === true }"
            slot="icon-only" name="send"></ion-icon>
        </ion-button>
      </div>
    </ion-col>
  </ion-row>
</ion-grid> -->

<!-- --------------------------------------------------------------------------------------------------------------------- -->
<!-- ----------new -->
<ion-grid>
  <ion-row id="message-text-area">

    <ion-col col-auto>

      <div class="start-buttons" style="position: absolute;display: flex; top: 2px;">

        <!-- CANNED RESPONSES -->
        <ng-container *ngIf="areVisibleCAR && supportMode">
          <div class="canned-responses-btn-wpr" style="margin-left: -5px;"
            tooltip="{{translationMap?.get('CANNED_RESPONSES')}}" [options]="tooltipOptions" placement="top">
            <ion-button ion-button fill="clear" class="canned-responses-btn" (click)="openCannedResponses()"
              [disabled]="!conversationWith?.startsWith(TYPE_SUPPORT_GROUP) || disableTextarea">
              <ion-icon slot="icon-only" lazy="true" name="flash-outline" style="font-size: 24px;"></ion-icon>
            </ion-button>
          </div>
          <div *ngIf="conversationWith?.startsWith(TYPE_SUPPORT_GROUP)  && tagsCannedCount === 0"
            tooltip="{{translationMap?.get('NO_CANNED_RESPONSES')}}" [options]="tooltipOptions" placement="top"
            class="no-canned-responses-btn-badge">
            <ion-icon name="alert-sharp" style="vertical-align: middle;"></ion-icon>
          </div>
          <div *ngIf="conversationWith?.startsWith(TYPE_SUPPORT_GROUP)  && tagsCannedCount > 0"
            tooltip="{{translationMap?.get('YES_CANNED_RESPONSES')}}" [options]="tooltipOptions" placement="top"
            class="canned-responses-btn-badge">
            <ion-icon name="information-sharp" style="vertical-align: middle;"></ion-icon>
          </div>
        </ng-container>

        <!-- UPLOAD ATTACHMENT -->
        <div class="upload-image-btn-wpr" tooltip="{{translationMap?.get('UPLOAD')}}" [options]="tooltipOptions"
          placement="top">
          <ion-button ion-button fill="clear" class="upload-image-btn" [disabled]="disableTextarea">
            <ion-icon slot="icon-only" lazy="true" name="attach-outline"
              style="font-size: 30px;transform: rotate(42deg);"></ion-icon>
            <input #fileInput type="file" (change)="onFileSelected($event)" capture="camera" id="file-input"
              [accept]="fileUploadAccept">
          </ion-button>
        </div>

        <!-- <ion-icon (click)="showEmojiPicker = !showEmojiPicker" color="secondary" name="happy" style="zoom:2;"></ion-icon> -->
        <!-- --------------------------------------------- -->
        <!-- Emoji Picker Button  tooltip="{{translationMap?.get('CANNED_RESPONSES')}}" [options]="tooltipOptions" placement="top" -->
        <!-- --------------------------------------------- -->
        <div class="emoji-picker-btn-wpr">
          <ion-button ion-button fill="clear" class="emoji-picker-btn" (click)="showEmojiPicker = !showEmojiPicker"
            [disabled]="disableTextarea">
            <!-- <ion-icon slot="icon-only" lazy="true" name="flash-outline" style="font-size: 24px;"></ion-icon> -->
            <ion-icon slot="icon-only" lazy="true" name="happy-outline" style="font-size: 24px;"></ion-icon>
          </ion-button>

          <!-- <div class="emojiContainer" [style.height]="showEmojiPicker?'300px':'0px'"> -->
          <!--Show/Hide emoji picker. Don't use *ngIf because the component will be created again and again and cause performance issue-->
          <!-- <emoji-picker (onEmojiSelect)="addEmoji($event)"></emoji-picker> -->
          <!-- { position: 'absolute', bottom: '20px', right: '20px' }" -->
          <!-- --------------------------------------------------------------------- -->
          <!-- https://www.npmjs.com/package/@ctrl/ngx-emoji-mart/v/1.0.6 -->
          <!-- --------------------------------------------------------------------- -->
          <!-- [style]="{ position: 'absolute', bottom: '53px', right: '-246px' }" -->
          <emoji-mart 
            [showPreview]="false" 
            [perLine]="emojiPerLine" 
            [style.visibility]="showEmojiPicker?'visible':'hidden'"  
            [include]="emojiiCategories"
            [color]="emojiColor"
            [custom]="customEmojis"
            [ngClass]="{'emoji-mart-desktop': !IS_ON_MOBILE_DEVICE, 'emoji-mart-mobile': IS_ON_MOBILE_DEVICE }"
            (emojiSelect)="addEmoji($event)">
          </emoji-mart>
          <!-- </div> -->

        </div>
      </div>





      <div class="text-message" [ngClass]="{'text-message-no-cr': areVisibleCAR === false || supportMode === false}">
        <ion-textarea id="ion-textarea" #messageTextArea #message_text_area #textArea rows="1"
          [placeholder]="translationMap?.get('LABEL_ENTER_MSG_SHORT')" 
          autosize="false" 
          auto-grow="true" 
          autofocus="true" 
          [value]=""
          [disabled]="disableTextarea"
          [(ngModel)]="messageString" 
          (ionChange)="ionChange($event);" 
          (keydown.enter)="onKeydown($event, messageString)" 
          (paste)="onPaste($event)">
        </ion-textarea>
      </div>

      <div class="buttons-right">
        <ion-button [disabled]="conversationEnabled === false" class="send-button right active" ion-button fill="clear"
          (click)="sendMessage(messageString)">
          <ion-icon
            [ngClass]="{'send-msg-disabled': conversationEnabled === false,'send-msg-activated': conversationEnabled === true }"
            slot="icon-only" name="send"></ion-icon>
        </ion-button>
      </div>
    </ion-col>

  </ion-row>
</ion-grid>